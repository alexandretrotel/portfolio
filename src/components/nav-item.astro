---
import Button from "@/components/ui/button.astro";
import { cn } from "@/lib/utils";

interface LinkItem {
  hidden: boolean;
  href: string;
  target?: string;
  title: string;
}

interface Props {
  link: LinkItem;
}

const { link } = Astro.props;
const { pathname } = Astro.url;

const normalizePath = (value: string): string => {
  const trimmed = value.replace(/\/+$/, "");
  return trimmed === "" ? "/" : trimmed;
};

const normalizedPathname = normalizePath(pathname);
const normalizedHref = normalizePath(link.href);

const isActive =
  (normalizedPathname.startsWith(normalizedHref) && normalizedHref !== "/") ||
  normalizedPathname === normalizedHref ||
  (normalizedHref === "/" && normalizedPathname === "");
---

{!link.hidden && (
        <div>
            <Button
                variant="ghost"
                class={cn(
                    "transition-transform active:scale-90",
                    isActive
                        ? "bg-accent dark:bg-accent/50"
                        : "text-foreground/60",
                )}
            >
                <a
                    class="font-medium text-sm transition-colors"
                    href={link.href}
                    target={link.target}
                >
                    {link.title}
                </a>
            </Button>
        </div>
    )}
