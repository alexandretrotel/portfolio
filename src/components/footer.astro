---
import { getRelativeLocaleUrl } from "astro:i18n";
import { defaultLocale, locales } from '@/i18n/locales';
import type { Locale } from '@/i18n/locales';
import { getLocaleFromUrl, stripLocaleFromPath } from "@/i18n/utils";
import { cn } from "@/lib/utils";

const currentLocale = getLocaleFromUrl(Astro.url);
const currentPath = stripLocaleFromPath(Astro.url.pathname);

const getLocaleUrl = (locale: Locale): string => {
  if (locale === defaultLocale) {
    return currentPath || "/";
  }
  return getRelativeLocaleUrl(locale, currentPath);
};
---

<footer class="w-full bg-background">
  <div class="mx-auto flex h-16 max-w-3xl items-center justify-start">
    <nav class="flex items-center gap-6" aria-label="Language selection">
      {locales.map((locale) => {
        const isActive = locale === currentLocale;
        return (
          <a
            href={getLocaleUrl(locale)}
            class={cn(
              "min-h-11 min-w-11 flex items-center justify-center px-2 font-medium text-base transition-colors hover:text-foreground",
              isActive
                ? "text-foreground"
                : "text-foreground/60"
            )}
            aria-current={isActive ? "page" : undefined}
          >
            \{locale.toLowerCase()}
          </a>
        );
      })}
    </nav>
  </div>
</footer>
